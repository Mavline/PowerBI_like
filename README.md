**Задание**  
Создать программу для прототипирования дашбордов в стиле Power BI с использованием LLM-модели. Программа должна обеспечивать следующие этапы и функции:

1. **Загрузка и чтение Excel-файла**  
   - Пользователь может загрузить Excel-файл через удобный интерфейс.  
   - После загрузки программа отображает все доступные листы из файла (например, Sheet1, Sheet2).  
   - Пользователь выбирает один из листов ).

2. **Выбор столбцов**  
   - После выбора листа происходит программный поиск заголовков в первых 20 строках  по принципу "самая длинная непустая строка , содеаржащая буквы" 
   - После определения заголовков для пользователя все столбцы этого листа.  
   - Пользователь указывает, какие столбцы будут использоваться для построения визуализаций, выпадающим списком, перетаскиванием или чекбоксами.  
   - На бэкенде реализуется процедура парсинга данных из выбранных полей, чтобы пользователь и модель впоследствии могли работать только с выбранными столбцами.

3. **Интерактивные визуальные элементы**  
   - В интерфейсе должны быть наглядно представлены доступные типы визуализации (все, по аналогии с имеющимися в наличии в PowerBI, например, столбчатая диаграмма, линейная диаграмма, круговая диаграмма и т.д.).  
   - Пользователь может кликнуть на подходящий тип визуализации или выбрать его в списке рядом с визуализацией элемента.  
   - Эти визуальные элементы должны быть легко доступны, чтобы пользователь мог сказать модели, какие именно диаграммы или графики ему нужны.

4. **Холст для дашборда**  
   - Программа должна иметь условный “холст” (рабочую область), где отображаются создаваемые визуализации.  
   - Интерфейс позволяет добавлять визуальные элементы один за другим, чтобы в итоге сформировать полноценный дашборд.  
   - Этот холст должен обновляться в реальном времени, отражая, что уже построено.
   - построенные элементы должны быть интерактивны по отношению к другим элементам дашборда: при клике на область визуального жлемента, связанного с данными в другом элементе - отображение/выделение данных, которые визуализируют элементы, должны меняться, как и в PowerBI. 

====================================================
# ВТОРОЙ ЭТАП.   

5. **Взаимодействие с LLM-моделью**
   - Через интерфейс чата пользователь может шаг за шагом управлять процессом создания дашборда моделью.
   - Пользователь может принимать участие в процессе создания дашборда, внося свои предложения и корректировки вручную.
   - Модель выполняет построение дашборда или помогает пользователю выбирать и создавать визуальные жлементы на основе выбранных столбцов.  
   - Пользователь формулирует запрос к модели: какой тип визуализации использовать, какие столбцы брать за ось X/Y, какие статистические или агрегирующие функции применять и т. д.  
   - Модель, получив доступ к функциям на бэкенде (например, для построения диаграмм с использованием сторонних библиотек вроде Chart.js), генерирует код или инструкции, которые немедленно визуализируются на холсте.  
   - Всё это происходит интерактивно: пользователь видит результат и при желании корректирует запросы к модели.

6. **Пошаговое создание дашборда**
   - Необходимо прописать функции в бэкенде, к которым будет иметь доступ модель для добавления и построения визуальных элементов. Эти же функции доступны и для пользователя под каполтом "взять элемент, перетащить элемент, добавить жлемент/поля данных, заполнить поля элемента полями с данными, переместить элементы по дашборду, поменять поля для данных в элементе, удалить жлемнт, поля с данными из элемента" - и прочие необходимые для функционирования приложения функции
   - Дашборд строится элемент за элементом. Сначала пользователь загружает данные, затем дает указание модели или самостоятельно выбирает визуальный элемент, указывает модели или выбирает самостоиятельно столбцы — модель строит диаграмму на холсте.  
   - Если нужно добавить вторую диаграмму (например, круговую для другого набора столбцов), пользователь повторяет действия сам или снова даёт указания модели, и она добавляет этот новый элемент к уже созданному дашборду.  
   - Процесс продолжается до тех пор, пока пользователь не будет доволен итоговым дашбордом.

7. **Редактирование визуализированных элементов**  
   - Пользователь и модель могут совместно как создавать, так и корректировать отдельные диаграммы: менять тип, цвет, параметры осей, включать/отключать легенду, фильтры и т. д.  
   - Это важно для интерактивности: “Что, если мы добавим фильтр по конкретной категории?”, “Что, если покажем сумму по кварталам вместо месяцев?”, и т. д.  
   - Такие изменения должны быть видны моментально.

8. **Сохранение результата**  
   - Готовый дашборд или его отдельные части должны быть скачиваемыми в любых визуальных форматах PNG, PDF или JPEG.  
   - Интерактивный формат остаётся внутри браузера (реализуется при помощи JavaScript/TypeScript-фреймворков или библиотек визуализации).
   - Дополнительно нужно предусмотреть возможность сохранения состояния дашборда в локальном формате (например, JSON-описание структуры).

9. **Бэкенд-функции для LLM**  
   - Для всего вышеперечисленного должны быть прописаны конкретные функции на бэкенде, которые модель сможет вызывать, чтобы создавать визуализации.  
   - Эти функции берут на вход выбранные столбцы, тип диаграммы и настройки и возвращают итоговую визуализацию (или данные для её отрисовки).  
   - Модель формирует вызовы этих функций на основе пользовательских запросов.

10. **Дополнительные пожелания**  
   - Оставить выбор конкретных библиотек (Chart.js, D3.js и т. д.) на усмотрение разработки, но обеспечить, чтобы LLM могла корректно ими пользоваться через функции.  
   - Не ограничиваться только диаграммами — при необходимости добавить другие визуальные компоненты (таблицы, карточки KPI, фильтры, слайсеры).  
   - Обеспечить понятные подсказки или обучающие всплывающие окна, если пользователь впервые сталкивается с программой.  " - но для начала обеспечим ручное управление и полную функциональность. Просмотри - выдай свое мнение, решение, вердикт, начни исправлять/строить - у тебя есть все инстврументы сейчас. Если надо - спрашивай обо всём, в том числе - согласования.